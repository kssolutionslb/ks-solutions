import{a as B,b as O,c as U,d as W}from"./chunk-22OEBY24.js";import{a as b}from"./chunk-VWLNPDP4.js";import"./chunk-JHOHYJWD.js";import{a as v}from"./chunk-FQRZVHIL.js";import"./chunk-O4Z7XCTG.js";import{a as q}from"./chunk-EYMYV4JT.js";import"./chunk-HMNUYURD.js";import{a as P}from"./chunk-DGQRDBDH.js";import{C as p,D as N,E as T,F as I,G as m,H as D,I as A,K as L,N as x,O as G,ha as R,na as V,pa as j}from"./chunk-YIOKFAT3.js";import"./chunk-CARY4E7O.js";import"./chunk-WLEIZKK2.js";import{Ac as g,Bc as M,Jb as r,N as d,Rc as w,Ub as a,Vb as l,Wb as c,a as f,jb as n,ka as u,oa as E,tc as S,uc as C,vc as y,wc as F,xc as k,yc as s}from"./chunk-E5CLUL7I.js";var z=()=>({text:"Email Type"}),H=()=>({preventInputSpace:!0}),J=(o,h,e)=>({label:o,control:h,extra:e}),K=()=>({text:"Active"}),Y=(o,h)=>({label:o,control:h}),Q=()=>({text:"Subject"}),ue=(()=>{class o{constructor(){this._crd=u(w),this._navService=u(P),this._EmailsService=u(b),this._currentScreen=q("email_crud"),this.editor=new W,this.htmlContent="",this.toolbar=[["bold","italic"],["underline","strike"],["code","blockquote"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"],["align_left","align_center","align_right","align_justify"],["horizontal_rule","format_clear","indent","outdent"],["superscript","subscript"],["undo","redo"]],this.colorPresets=["red","#FF0000","rgb(255, 0, 0)"],this.form=new I({emailType:new m("",[p.required]),subject:new m("",[p.required]),body:new m("",[p.required]),active:new m(!1)})}ngOnInit(){let e=this._navService.readUrlParams().ID;this._navService.updateNav({show:!0,back:!0,title:this._currentScreen.screenName,buttons:[{label:{text:"Save"},prefixIcon:{icon:"icon_save"},hide:!(this._currentScreen.insert&&!e||e&&this._currentScreen.update),onClick:()=>{this._save()}}]}),e&&this._getEmail(e)}ngOnDestroy(){this.editor.destroy()}_getEmail(e){this._EmailsService.getEmailById(e).pipe(d(1)).subscribe(t=>{t&&t.data&&this._updateEmail(t.data)})}_save(){if(this.form.controls.body.setValue(this.htmlContent),!R(this.form)){this._crd.markForCheck();return}let e=this.form.value;this._email?this._EmailsService.updateEmail(f(f({},this._email),e)).pipe(d(1)).subscribe(t=>{t&&t.data&&this._updateEmail(t.data),this._navService.navigateTo(v.LAYOUT.children.EMAILS.children.EMAILS.route)}):this._EmailsService.addEmail(e).pipe(d(1)).subscribe(t=>{t&&t.data&&this._updateEmail(t.data),this._navService.navigateTo(v.LAYOUT.children.EMAILS.children.EMAILS.route)})}_updateEmail(e){this._email=e,this.htmlContent=e.body,this.form.patchValue(e),this._crd.markForCheck()}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=E({type:o,selectors:[["ks-solutions-email"]],standalone:!0,features:[F([b]),k],decls:14,vars:22,consts:[[3,"formGroup"],[1,"container-fluid"],[1,"row","align-items-center"],[1,"col-12","col-md-6","col-lg-4"],[3,"config"],[1,"col-12","col-md-6","col-lg-4","pb-3"],[1,"row"],[1,"col-12"],[3,"toolbar","editor"],[3,"ngModelChange","editor","ngModel"]],template:function(t,i){t&1&&(a(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),c(4,"ks-base-input",4),l(),a(5,"div",5),c(6,"ks-base-checkbox",4),l()(),a(7,"div",6)(8,"div",7),c(9,"ks-base-input",4),l()()()(),a(10,"div",6)(11,"div",7),c(12,"ngx-editor-menu",8),a(13,"ngx-editor",9),y("ngModelChange",function(_){return C(i.htmlContent,_)||(i.htmlContent=_),_}),l()()()),t&2&&(r("formGroup",i.form),n(4),r("config",M(10,J,s(8,z),i.form.controls.emailType,s(9,H))),n(2),r("config",g(15,Y,s(14,K),i.form.controls.active)),n(3),r("config",g(19,Y,s(18,Q),i.form.controls.subject)),n(3),r("toolbar",i.toolbar)("editor",i.editor),n(),r("editor",i.editor),S("ngModel",i.htmlContent))},dependencies:[V,j,G,A,N,T,L,U,B,O,x,D],changeDetection:0})}}return o})();export{ue as EmailComponent};
