import{a as E}from"./chunk-3SSBONDS.js";import{a as M}from"./chunk-RN7YLSYN.js";import{a as N}from"./chunk-YLXVY45S.js";import{a as o}from"./chunk-X64TF3C4.js";import{a as H}from"./chunk-5GWMFGPU.js";import"./chunk-HMNUYURD.js";import{a as w}from"./chunk-NNKWD6R3.js";import{M as S,_ as v,ba as C,sa as T}from"./chunk-EYM2RH5N.js";import"./chunk-CARY4E7O.js";import"./chunk-F5WOQGUX.js";import{Fa as g,Hb as _,N as r,Nb as b,Ub as x,a as s,bc as y,ea as d,ka as n,n as m,o as p,oa as u,sb as c,uc as f,vc as I,zb as h}from"./chunk-RQMRH3XI.js";var l=(()=>{class t{constructor(){this._networkService=n(C),this._templates=new p([]),this.templates$=this._templates.asObservable()}getAllMenuTemplates(){this._networkService.get(o.MENU_TEMPLATES.menus).pipe(r(1)).subscribe({next:e=>{e&&e.data&&this._templates.next(e.data)}})}addMenuTemplate(e){return this._networkService.post(o.MENU_TEMPLATES.menus,e)}updateMenuTemplate(e){return this._networkService.patch(o.MENU_TEMPLATES.menus,e,e._id)}deleteMenuTemplate(e){this._networkService.delete(o.MENU_TEMPLATES.menus,void 0,e._id).pipe(r(1)).subscribe({next:()=>{this._updateMenus(e,"delete")}})}_updateMenus(e,a){E.UpdateArrayBehaviorSubject(this._templates,e,a)}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275prov=d({token:t,factory:t.\u0275fac})}}return t})();function A(t,F){if(t&1&&x(0,"ks-basic-grid",0),t&2){let e=y();_("config",e.gridConfig)("refresh$",e.refresh$)}}var X=(()=>{class t{constructor(){this._destroyRef=n(g),this._navService=n(w),this._lovService=n(N),this._dialog=n(v),this._menuTemplateService=n(l),this._currentScreen=H("menu_templates_listing"),this._data=[],this.refresh$=new m}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:this._currentScreen.screenName,buttons:[{label:{text:"Create New"},prefixIcon:{icon:"icon_plus_circle"},hide:!this._currentScreen.insert,onClick:()=>{this._openMenu()}}]}),this._menuTemplateService.getAllMenuTemplates(),this._initializeGrid(),this._menuTemplateService.templates$.pipe(S(this._destroyRef)).subscribe(e=>{this._data=e,this.refresh$.next({data:this._data})})}_initializeGrid(){this.gridConfig={data:c([]),defaultPagination:100,maxTableHeight:M.maxTableHeightWithSearch,noDataMessage:{text:"No Menu Templates Found"},features:{showSearch:!0,trackChanges:!0},elevation:2,columns:[{field:"name",title:"Name",extraStyles:{"min-width":"120px","max-width":"120px"},type:"string"},{field:"templateId",title:"Template Id",extraStyles:{"min-width":"100px","max-width":"100px"},type:"string"},{field:"isCustom",title:"Is Custom",type:"chip",extraStyles:{"min-width":"100px","max-width":"100px"},position:"p-start",truthy:{false:"No",true:"Yes"},setChipClass:e=>e.isCustom===!0?"rounded rounded-5 px-3 py-1 text-bg-success cs-w-120":"rounded rounded-5 px-3 py-1 text-bg-danger cs-w-120"},{field:"usageCount",title:"Usage",type:"number",extraStyles:{width:"100px"}},{field:"ownerId",title:"Owner",type:"select",stream:{value:"_id",name:"name",stream:this._lovService.userLov$},extraStyles:{"min-width":"100px"}},{field:"createdAt",title:"Created At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}},{field:"updatedAt",title:"Last Updated At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}}],actionsColumn:{enabled:this._currentScreen.update||this._currentScreen.delete,maxButtons:window.innerWidth<700?1:void 0,maxWidth:window.innerWidth<700?void 0:"110px",minWidth:window.innerWidth<700?void 0:"110px",buttons:[{prefixIcon:{icon:"icon_edit"},label:{text:"Edit"},onClickFn:e=>this._openMenu(e),isVisibleFn:()=>this._currentScreen.update,matType:"mat-icon-button"},{prefixIcon:{icon:"icon_delete",color:"red"},label:{text:"Delete"},onClickFn:e=>this._deleteInventory(e),isVisibleFn:()=>this._currentScreen.delete,matType:"mat-icon-button"}]}}}_openMenu(e){let a={title:{text:e?"Edit Menu Template":"Add Menu Template"},form:{value:e,useExpansionPanel:!0,expandOnlyOne:!0,groups:[{id:1,name:{text:"Menu Fields",addClass:"h5 mb-1",tag:"p"},order:1},{id:2,name:{text:"Item Fields",addClass:"h5 mb-1",tag:"p"},order:2},{id:3,name:{text:"Subcategory Fields",addClass:"h5 mb-1",tag:"p"},order:3},{id:4,name:{text:"Category Fields",addClass:"h5 mb-1",tag:"p"},order:4}],fields:[{name:"name",label:{text:"Template Name"},required:!0,type:"text"},{name:"templateId",label:{text:"Template Id"},required:!0,type:"text"},{name:"ownerId",type:"select",stream:this._lovService.userLov$,transformer:{valueKey:"_id",nameKey:"name"},label:{text:"Template Owner"}},{name:"isCustom",label:{text:"Is Custom"},type:"checkbox"},{name:"menu_storeLogo",label:{text:"Has Store Logo"},type:"toggle",groupId:1},{name:"menu_translation",label:{text:"Has Translation"},type:"toggle",groupId:1},{name:"menu_category",label:{text:"Has Categories"},type:"toggle",groupId:1},{name:"menu_subcategory",label:{text:"Has Subcategories"},type:"toggle",groupId:1},{name:"menu_item",label:{text:"Has Items"},type:"toggle",groupId:1},{name:"menu_quote",label:{text:"Has Quote"},type:"toggle",groupId:1},{name:"menu_aboutUs",label:{text:"Has About Us"},type:"toggle",groupId:1},{name:"menu_phoneNumber",label:{text:"Has Phone Number"},type:"toggle",groupId:1},{name:"menu_email",label:{text:"Has Email"},type:"toggle",groupId:1},{name:"menu_whatsapp",label:{text:"Has Whatsapp"},type:"toggle",groupId:1},{name:"menu_location",label:{text:"Has Location"},type:"toggle",groupId:1},{name:"menu_instagram",label:{text:"Has Instagram"},type:"toggle",groupId:1},{name:"menu_facebook",label:{text:"Has Facebook"},type:"toggle",groupId:1},{name:"item_img",label:{text:"Has Item Img"},type:"toggle",groupId:2},{name:"item_bgImg",label:{text:"Has Item Bg Img"},type:"toggle",groupId:2},{name:"item_calories",label:{text:"Has Item Calories"},type:"toggle",groupId:2},{name:"item_is_Starred",label:{text:"Has Item Is Starred"},type:"toggle",groupId:2},{name:"item_is_New",label:{text:"Has Item Is New"},type:"toggle",groupId:2},{name:"item_description",label:{text:"Has Item Description"},type:"toggle",groupId:2},{name:"item_unit",label:{text:"Has Item Unit"},type:"toggle",groupId:2},{name:"subcategory_img",label:{text:"Has Subcategory Img"},type:"toggle",groupId:3},{name:"subcategory_bgImg",label:{text:"Has Subcategory Bg Img"},type:"toggle",groupId:3},{name:"subcategory_pageNb",label:{text:"Has Subcategory Page Number"},type:"toggle",groupId:3},{name:"category_img",label:{text:"Has Category Img"},type:"toggle",groupId:4},{name:"category_bgImg",label:{text:"Has Category Bg Img"},type:"toggle",groupId:4}]},beforeCloseObservable:i=>e?this._menuTemplateService.updateMenuTemplate(s(s({},e),i)):this._menuTemplateService.addMenuTemplate(i),getAfterSuccessResponse:i=>{i.data&&this._menuTemplateService._updateMenus(i.data,e?"edit":"add")}};this._dialog.openFormPopup(a,"1000px")}_deleteInventory(e){let a={title:{text:"Confirm Delete"},message:{text:"Are you sure you want to delete this menu template?"}};this._dialog.openConfirmPopup(a).afterClosed().pipe(r(1)).subscribe(i=>{i&&e?._id&&this._menuTemplateService.deleteMenuTemplate(e)})}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=u({type:t,selectors:[["ks-solutions-menu-template-listing"]],standalone:!0,features:[f([l]),I],decls:1,vars:1,consts:[[3,"config","refresh$"]],template:function(a,i){a&1&&h(0,A,1,2,"ks-basic-grid",0),a&2&&b(i.gridConfig?0:-1)},dependencies:[T],changeDetection:0})}}return t})();export{X as MenuTemplatesComponent};
