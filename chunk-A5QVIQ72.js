import{a as G}from"./chunk-VE6CGTOR.js";import{a as O}from"./chunk-JHOHYJWD.js";import{a as V}from"./chunk-5BWCYXSX.js";import{a as W}from"./chunk-O3DFJTSE.js";import{a as m}from"./chunk-GR3MB6LF.js";import{a as l}from"./chunk-GQ637NOE.js";import"./chunk-HMNUYURD.js";import{a as U}from"./chunk-72TK6UK2.js";import{O as P,aa as y,ba as R,da as z,ra as B,ua as $,v as D,va as j,w as L}from"./chunk-XXZS4MWG.js";import"./chunk-CARY4E7O.js";import"./chunk-4KKA7PE6.js";import{Ab as _,Fa as k,Ib as r,N as o,Ob as b,Tb as I,Ub as C,Vb as h,a as s,ac as H,b as M,cc as f,ea as w,ib as g,jb as v,ka as n,n as p,nc as N,o as d,oa as u,oc as E,tb as c,vc as F,wc as x,yc as A}from"./chunk-VO6IE2C5.js";var T=(()=>{class t{constructor(){this._networkService=n(z),this._templates=new d([]),this.templates$=this._templates.asObservable()}getAllMenuTemplates(){this._networkService.get(m.MENU_TEMPLATES.menus).pipe(o(1)).subscribe({next:e=>{e&&e.data&&this._templates.next(e.data)}})}addMenuTemplate(e){return this._networkService.post(m.MENU_TEMPLATES.menus,e)}updateMenuTemplate(e){return this._networkService.patch(m.MENU_TEMPLATES.menus,e,e._id)}deleteMenuTemplate(e){this._networkService.delete(m.MENU_TEMPLATES.menus,void 0,e._id).pipe(o(1)).subscribe({next:()=>{this._updateMenus(e,"delete")}})}_updateMenus(e,a){O.UpdateArrayBehaviorSubject(this._templates,e,a,"_id")}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275prov=w({token:t,factory:t.\u0275fac})}}return t})();var J=t=>({loading:t,disableInteractions:!0,position:"fixed"});function X(t,Q){if(t&1&&h(0,"ks-loader-overlay",0),t&2){let e=f();r("config",A(1,J,e.trueSignal))}}var q=(()=>{class t{constructor(e,a){this._dialogRef=e,this.data=a,this._dialog=n(y),this._loaderService=n(R),this._currentScreen=l("services_listing"),this._save$=new p,this.trueSignal=c(!0),this.loading=this._loaderService.isLoading,this.cardConfig={header:{title:{text:"Template Css",tag:"h3",fontWeight:"700"},position:"center",suffixButton:{label:{text:"Close"},matType:"mat-icon-button",prefixIcon:{icon:"icon_x_circle"},onClick:()=>{this._dialogRef.close()}}},content:{addClass:"card p-2"},footer:{buttons:this._currentScreen.update?[{label:{text:"Save"},matType:"mat-flat-button",prefixIcon:{icon:"icon_save"},onClick:()=>{this._save()}},{label:{text:"Test"},matType:"mat-stroked-button",onClick:()=>{this._test()}}]:[{label:{text:"Close"},onClick:()=>{this._dialogRef.close()},matType:"mat-flat-button"}],position:"center"}},this.config={save$:this._save$,currentScreen:l("menu_invoice"),stream:new d({fields:[]})}}ngAfterViewInit(){this.data?.template?.cssForm&&this.config.stream.next(this.data.template.cssForm)}onSave(e){this.data?.templateService.updateMenuTemplate(M(s({},this.data.template),{cssForm:e})).pipe(o(1)).subscribe(a=>{a?.data&&(this.data?.templateService._updateMenus(a.data,"edit"),this._dialogRef.close())})}onTest(e){this._dialog.openFormPopup({title:{text:"Test"},form:e,hideClearButton:!0,saveButton:{label:{text:"Test Save"},matType:"mat-flat-button"}})}_save(){this._save$.next("save")}_test(){this._save$.next("test")}static{this.\u0275fac=function(a){return new(a||t)(v(D),v(L))}}static{this.\u0275cmp=u({type:t,selectors:[["ks-solutions-template-css"]],standalone:!0,features:[x],decls:5,vars:4,consts:[[3,"config"],[1,"h3","text-center"],[3,"save","test","config"]],template:function(a,i){a&1&&(I(0,"ks-base-card",0)(1,"div",1),N(2),C(),I(3,"kss-lib-form-builder",2),H("save",function(S){return i.onSave(S)})("test",function(S){return i.onTest(S)}),C()(),_(4,X,1,3,"ks-loader-overlay",0)),a&2&&(r("config",i.cardConfig),g(2),E(i.data==null||i.data.template==null?null:i.data.template.name),g(),r("config",i.config),g(),b(i.loading()?4:-1))},dependencies:[B,G,$],changeDetection:0})}}return t})();function Z(t,Q){if(t&1&&h(0,"ks-basic-grid",0),t&2){let e=f();r("config",e.gridConfig)("refresh$",e.refresh$)}}var Ee=(()=>{class t{constructor(){this._destroyRef=n(k),this._navService=n(U),this._lovService=n(W),this._dialog=n(y),this._menuTemplateService=n(T),this._currentScreen=l("menu_templates_listing"),this._data=[],this.refresh$=new p}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:this._currentScreen.screenName,buttons:[{label:{text:"Create New"},prefixIcon:{icon:"icon_plus_circle"},hide:!this._currentScreen.insert,onClick:()=>{this._openMenu()}}]}),this._menuTemplateService.getAllMenuTemplates(),this._initializeGrid(),this._menuTemplateService.templates$.pipe(P(this._destroyRef)).subscribe(e=>{this._data=e,this.refresh$.next({data:this._data})})}_initializeGrid(){this.gridConfig={data:c([]),defaultPagination:100,maxTableHeight:V.maxTableHeightWithSearch,noDataMessage:{text:"No Menu Templates Found"},features:{showSearch:!0,trackChanges:!0},elevation:2,columns:[{field:"name",title:"Name",extraStyles:{"min-width":"120px","max-width":"120px"},type:"string"},{field:"templateId",title:"Template Id",extraStyles:{"min-width":"100px","max-width":"100px"},type:"string"},{field:"isCustom",title:"Is Custom",type:"chip",extraStyles:{"min-width":"100px","max-width":"100px"},position:"p-start",truthy:{false:"No",true:"Yes"},setChipClass:e=>e.isCustom===!0?"rounded rounded-5 px-3 py-1 text-bg-success cs-w-120":"rounded rounded-5 px-3 py-1 text-bg-danger cs-w-120"},{field:"usageCount",title:"Usage",type:"number",extraStyles:{width:"100px"}},{field:"ownerId",title:"Owner",type:"select",stream:{value:"_id",name:"name",stream:this._lovService.userLov$},extraStyles:{"min-width":"100px"}},{field:"createdAt",title:"Created At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}},{field:"updatedAt",title:"Last Updated At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}}],actionsColumn:{enabled:this._currentScreen.update||this._currentScreen.delete,maxButtons:window.innerWidth<700?1:void 0,width:window.innerWidth<700?void 0:"160px",maxWidth:window.innerWidth<700?void 0:"160px",minWidth:window.innerWidth<700?void 0:"160px",buttons:[{prefixIcon:{icon:"icon_settings"},label:{text:"Settings"},onClickFn:e=>this._openTemplateCss(e),isVisibleFn:()=>this._currentScreen.update,matType:"mat-icon-button"},{prefixIcon:{icon:"icon_edit"},label:{text:"Edit"},onClickFn:e=>this._openMenu(e),isVisibleFn:()=>this._currentScreen.update,matType:"mat-icon-button"},{prefixIcon:{icon:"icon_delete",color:"red"},label:{text:"Delete"},onClickFn:e=>this._deleteInventory(e),isVisibleFn:()=>this._currentScreen.delete,matType:"mat-icon-button"}]}}}_openMenu(e){let a={title:{text:e?"Edit Menu Template":"Add Menu Template"},form:{value:e,useExpansionPanel:!0,expandOnlyOne:!0,groups:[{id:1,name:{text:"Menu Fields",addClass:"h5 mb-1",tag:"p"},order:1},{id:2,name:{text:"Item Fields",addClass:"h5 mb-1",tag:"p"},order:2},{id:3,name:{text:"Subcategory Fields",addClass:"h5 mb-1",tag:"p"},order:3},{id:4,name:{text:"Category Fields",addClass:"h5 mb-1",tag:"p"},order:4}],fields:[{name:"name",label:{text:"Template Name"},required:!0,type:"text"},{name:"templateId",label:{text:"Template Id"},required:!0,type:"text"},{name:"ownerId",type:"select",stream:this._lovService.userLov$,transformer:{valueKey:"_id",nameKey:"name"},label:{text:"Template Owner"}},{name:"isCustom",label:{text:"Is Custom"},type:"checkbox"},{name:"menu_storeLogo_max_size",label:{text:"Store Logo Max Size"},type:"number",groupId:1,disableNegativeValues:!0},{name:"menu_storeLogo",label:{text:"Has Store Logo"},type:"toggle",groupId:1},{name:"menu_translation",label:{text:"Has Translation"},type:"toggle",groupId:1},{name:"menu_category",label:{text:"Has Categories"},type:"toggle",groupId:1},{name:"menu_subcategory",label:{text:"Has Subcategories"},type:"toggle",groupId:1},{name:"menu_item",label:{text:"Has Items"},type:"toggle",groupId:1},{name:"menu_quote",label:{text:"Has Quote"},type:"toggle",groupId:1},{name:"menu_aboutUs",label:{text:"Has About Us"},type:"toggle",groupId:1},{name:"menu_phoneNumber",label:{text:"Has Phone Number"},type:"toggle",groupId:1},{name:"menu_email",label:{text:"Has Email"},type:"toggle",groupId:1},{name:"menu_whatsapp",label:{text:"Has Whatsapp"},type:"toggle",groupId:1},{name:"menu_location",label:{text:"Has Location"},type:"toggle",groupId:1},{name:"menu_instagram",label:{text:"Has Instagram"},type:"toggle",groupId:1},{name:"menu_facebook",label:{text:"Has Facebook"},type:"toggle",groupId:1},{name:"item_img_max_size",label:{text:"Item Img Max Size"},type:"number",groupId:2,disableNegativeValues:!0},{name:"item_bgImg_max_size",label:{text:"Item Bg Img Max Size"},type:"number",groupId:2,disableNegativeValues:!0},{name:"item_img",label:{text:"Has Item Img"},type:"toggle",groupId:2},{name:"item_bgImg",label:{text:"Has Item Bg Img"},type:"toggle",groupId:2},{name:"item_calories",label:{text:"Has Item Calories"},type:"toggle",groupId:2},{name:"item_is_Starred",label:{text:"Has Item Is Starred"},type:"toggle",groupId:2},{name:"item_is_New",label:{text:"Has Item Is New"},type:"toggle",groupId:2},{name:"item_description",label:{text:"Has Item Description"},type:"toggle",groupId:2},{name:"item_unit",label:{text:"Has Item Unit"},type:"toggle",groupId:2},{name:"subcategory_img_max_size",label:{text:"Subcategory Img Max Size"},type:"number",groupId:3,disableNegativeValues:!0},{name:"subcategory_bgImg_max_size",label:{text:"Subcategory Bg Img Max Size"},type:"number",groupId:3,disableNegativeValues:!0},{name:"subcategory_img",label:{text:"Has Subcategory Img"},type:"toggle",groupId:3},{name:"subcategory_bgImg",label:{text:"Has Subcategory Bg Img"},type:"toggle",groupId:3},{name:"subcategory_pageNb",label:{text:"Has Subcategory Page Number"},type:"toggle",groupId:3},{name:"subcategory_note",label:{text:"Has Subcategory Notes"},type:"toggle",groupId:3},{name:"category_img_max_size",label:{text:"Category Img Max Size"},type:"number",groupId:4,disableNegativeValues:!0},{name:"category_bgImg_max_size",label:{text:"Category Bg Img Max Size"},type:"number",groupId:4,disableNegativeValues:!0},{name:"category_img",label:{text:"Has Category Img"},type:"toggle",groupId:4},{name:"category_bgImg",label:{text:"Has Category Bg Img"},type:"toggle",groupId:4}]},beforeCloseObservable:i=>e?this._menuTemplateService.updateMenuTemplate(s(s({},e),i)):this._menuTemplateService.addMenuTemplate(i),getAfterSuccessResponse:i=>{i.data&&this._menuTemplateService._updateMenus(i.data,e?"edit":"add")}};this._dialog.openFormPopup(a,"1000px")}_deleteInventory(e){let a={title:{text:"Confirm Delete"},message:{text:"Are you sure you want to delete this menu template?"}};this._dialog.openConfirmPopup(a).afterClosed().pipe(o(1)).subscribe(i=>{i&&e?._id&&this._menuTemplateService.deleteMenuTemplate(e)})}_openTemplateCss(e){this._dialog.open(q,{data:{templateService:this._menuTemplateService,template:e},width:"95vw",maxWidth:"100%"})}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=u({type:t,selectors:[["ks-solutions-menu-template-listing"]],standalone:!0,features:[F([T]),x],decls:1,vars:1,consts:[[3,"config","refresh$"]],template:function(a,i){a&1&&_(0,Z,1,2,"ks-basic-grid",0),a&2&&b(i.gridConfig?0:-1)},dependencies:[j],changeDetection:0})}}return t})();export{Ee as MenuTemplatesComponent};
