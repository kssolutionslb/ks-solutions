import{a as V}from"./chunk-MJ7DCTJM.js";import{a as S}from"./chunk-ACYZVNWI.js";import{a as f}from"./chunk-2OEIZLNB.js";import"./chunk-HMNUYURD.js";import{a as D}from"./chunk-NZP3AJU7.js";import{a as y}from"./chunk-5LHP7IWU.js";import{aa as U,da as O,la as R,ra as K}from"./chunk-7Y4QU53B.js";import"./chunk-CARY4E7O.js";import"./chunk-QLWHFAAO.js";import{Ec as E,Fc as F,Hb as h,N as M,Nb as d,Ob as b,Qb as T,Rb as I,Sb as _,Tb as u,Ub as C,a as A,b as $,bc as m,ea as N,hb as s,hd as H,ka as c,oa as P,sb as g,uc as B,vc as w,wc as k,y as x,zb as l}from"./chunk-72DPVO72.js";var L=(()=>{class t{constructor(){this._navbarService=c(y),this._networkService=c(O)}getServiceById(e){return this._networkService.post(D.SERVICE_DATA.byId,{serviceId:e})}saveService(e,i,r){return this._networkService.patch(D.SERVICE_DATA.bulkSave,G({serviceId:i,data:e,serviceDataId:r}))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=N({token:t,factory:t.\u0275fac})}}return t})();function G(t){let n=new FormData,e=0;function i(o){if(Array.isArray(o))o.forEach(i);else if(typeof o=="object"&&o!==null)for(let p in o){let a=o[p];if(a instanceof File){let v=`file_${e++}`;n.append(v,a),o[p]=`__${v}__`}else if(a&&typeof a=="object"&&("_file"in a||"_deleteFile"in a||"_initialFileUrl"in a)){let v=`file_${e++}`;a._file instanceof File&&(n.append(v,a._file),o[p]={_initialFileUrl:a._initialFileUrl||"",_deleteFile:a._deleteFile||!1,_file:`__${v}__`})}else i(a)}}let r=structuredClone(t);return i(r),n.append("payload",JSON.stringify(r)),n}var q=()=>({text:"Menus",tag:"h2",fontWeight:"500",case:"titlecase"}),W=()=>({text:"Services",tag:"h2",fontWeight:"500",case:"titlecase"});function J(t,n){if(t&1&&(_(0,"div",3)(1,"div",4),C(2,"ks-base-card",5),u()()),t&2){let e=m().$implicit,i=m(3);s(2),h("config",i.getCardConfig(e))}}function z(t,n){if(t&1&&l(0,J,3,1,"div",3),t&2){let e=n.$implicit;d(e.type==="menu"?0:-1)}}function Q(t,n){if(t&1&&(C(0,"ks-base-label",1),_(1,"div",2),T(2,z,1,1,null,null,b),u()),t&2){let e=m();h("config",k(1,q)),s(2),I(e)}}function X(t,n){t&1&&l(0,Q,4,2),t&2&&d(n.length?0:-1)}function Z(t,n){if(t&1&&(_(0,"div",3)(1,"div",4),C(2,"ks-base-card",5),u()()),t&2){let e=m().$implicit,i=m(3);s(2),h("config",i.getServiceCardConfig(e))}}function j(t,n){if(t&1&&l(0,Z,3,1,"div",3),t&2){let e=n.$implicit;d(e.type==="service"?0:-1)}}function ee(t,n){if(t&1&&(_(0,"div",6),C(1,"ks-base-label",1),_(2,"div",2),T(3,j,1,1,null,null,b),u()()),t&2){let e=m();s(),h("config",k(1,W)),s(2),I(e)}}function te(t,n){t&1&&l(0,ee,5,2,"div",6),t&2&&d(n.length?0:-1)}var Se=(()=>{class t{constructor(){this._lovService=c(V),this._dialog=c(U),this._navService=c(y),this._serviceDataService=c(L),this._servicesAndMenus$=this._lovService.menusAndServicesLov$,this._menuInvoiceScreen=f("menu_invoice").fullPath,this._menuSettingsScreen=f("menu_settings").fullPath,this._serviceSettingsScreen=f("service_settings").fullPath,this._serviceDataScreen=f("service_data"),this._menuCrudScreen=f("menu_crud").fullPath,this.menus$=this._servicesAndMenus$.pipe(x(e=>e.filter(i=>i.type==="menu"))),this.services$=this._servicesAndMenus$.pipe(x(e=>e.filter(i=>i.type==="service")))}ngOnInit(){this._lovService.getMenusAndServicesLov(),this._navService.updateNav({show:!1,back:!1})}getCardConfig(e){return{header:{title:{text:e.name,tag:"h4",translate:!1,addClass:"pt-3"},suffixButton:this._menuSettingsScreen?{label:{text:"Settings"},prefixIcon:{icon:"icon_settings"},matType:"mat-icon-button",onClick:()=>{this._navService.navigateTo(S.LAYOUT.children.MENU_SETTINGS.route,{MenuId:e._id})}}:void 0},footer:{buttons:[{label:{text:"Invoice"},matType:"mat-stroked-button",prefixIcon:{icon:"icon_file"},onClick:()=>{this._navService.navigateTo(S.LAYOUT.children.INVOICE.route,{MenuId:e._id})},hide:g(!(e.hasInvoice&&this._menuInvoiceScreen))},{label:{text:"Edit Menu Data"},matType:"mat-stroked-button",prefixIcon:{icon:"icon_edit"},onClick:()=>{this._navService.navigateTo(S.LAYOUT.children.MENU.route,{MenuId:e._id})},hide:g(!this._menuCrudScreen)}],position:"center"},addClass:"h-100"}}getServiceCardConfig(e){return{header:{title:{text:e.name,tag:"h4"},suffixButton:this._serviceSettingsScreen?{label:{text:"Settings"},prefixIcon:{icon:"icon_settings"},matType:"mat-icon-button",onClick:()=>{this._navService.navigateTo(S.LAYOUT.children.SERVICE_SETTINGS.route,{ServiceId:e._id})}}:void 0},footer:{buttons:[{label:{text:"Edit Service Data"},matType:"mat-stroked-button",prefixIcon:{icon:"icon_edit"},onClick:()=>{this._serviceDataService.getServiceById(e._id).pipe(M(1)).subscribe(i=>{if(i.data){let r=i.data;this._dialog.openFormPopup({hideClearButton:!0,title:{text:"Service Settings"},form:$(A({},r.service.fields),{value:r?.data?.data}),beforeCloseObservable:o=>this._serviceDataService.saveService(o,e._id,r?.data?._id)})}})},hide:g(!this._serviceDataScreen?.fullPath||!e.editable)}],position:"center"},addClass:"h-100"}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=P({type:t,selectors:[["ks-solutions-layout-home-page"]],standalone:!0,features:[B([L]),w],decls:5,vars:6,consts:[[1,"container-fluid","my-5"],[1,"text-center",3,"config"],[1,"row"],[1,"col-12","col-sm-6","col-md-6","col-lg-4","col-xl-3","mb-4"],[1,"cs-card","h-100","shadow-sm","border","border-1","rounded-2"],[3,"config"],[1,"mt-3"]],template:function(i,r){if(i&1&&(_(0,"div",0),l(1,X,1,1),E(2,"async"),l(3,te,1,1),E(4,"async"),u()),i&2){let o,p;s(),d((o=F(2,2,r.menus$))?1:-1,o),s(2),d((p=F(4,4,r.services$))?3:-1,p)}},dependencies:[H,R,K],styles:[".cs-card[_ngcontent-%COMP%]{transition:transform .3s}"],changeDetection:0})}}return t})();export{Se as LayoutHomeComponent};
