import{a as E}from"./chunk-JHOHYJWD.js";import{a as H}from"./chunk-5BWCYXSX.js";import{a as k}from"./chunk-N4O6L2UG.js";import{a as m}from"./chunk-ZAKCWEXA.js";import{a as o}from"./chunk-UA3J3SVI.js";import{a as N}from"./chunk-2OEIZLNB.js";import"./chunk-HMNUYURD.js";import{a as w}from"./chunk-5LHP7IWU.js";import{O as v,aa as C,da as T,va as M}from"./chunk-7Y4QU53B.js";import"./chunk-CARY4E7O.js";import"./chunk-QLWHFAAO.js";import{Fa as c,Hb as x,N as n,Nb as y,Ub as h,a as s,bc as I,ea as d,ka as r,n as p,o as u,oa as g,sb as b,uc as f,vc as S,zb as _}from"./chunk-72DPVO72.js";var l=(()=>{class t{constructor(){this._networkService=r(T),this._templates=new u([]),this.templates$=this._templates.asObservable()}getAllMenuTemplates(){this._networkService.get(o.MENU_TEMPLATES.menus).pipe(n(1)).subscribe({next:e=>{e&&e.data&&this._templates.next(e.data)}})}addMenuTemplate(e){return this._networkService.post(o.MENU_TEMPLATES.menus,m(e))}updateMenuTemplate(e){return this._networkService.patch(o.MENU_TEMPLATES.menus,m(e),e._id)}deleteMenuTemplate(e){this._networkService.delete(o.MENU_TEMPLATES.menus,void 0,e._id).pipe(n(1)).subscribe({next:()=>{this._updateMenus(e,"delete")}})}_updateMenus(e,a){E.UpdateArrayBehaviorSubject(this._templates,e,a,"_id")}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275prov=d({token:t,factory:t.\u0275fac})}}return t})();function A(t,P){if(t&1&&h(0,"ks-basic-grid",0),t&2){let e=I();x("config",e.gridConfig)("refresh$",e.refresh$)}}var ee=(()=>{class t{constructor(){this._destroyRef=r(c),this._navService=r(w),this._lovService=r(k),this._dialog=r(C),this._menuTemplateService=r(l),this._currentScreen=N("menu_templates_listing"),this._data=[],this.refresh$=new p}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:this._currentScreen.screenName,buttons:[{label:{text:"Create New"},prefixIcon:{icon:"icon_plus_circle"},hide:!this._currentScreen.insert,onClick:()=>{this._openMenu()}}]}),this._menuTemplateService.getAllMenuTemplates(),this._initializeGrid(),this._menuTemplateService.templates$.pipe(v(this._destroyRef)).subscribe(e=>{this._data=e,this.refresh$.next({data:this._data})})}_initializeGrid(){this.gridConfig={data:b([]),defaultPagination:100,maxTableHeight:H.maxTableHeightWithSearch,noDataMessage:{text:"No Menu Templates Found"},features:{showSearch:!0,trackChanges:!0},elevation:2,columns:[{field:"name",title:"Name",extraStyles:{"min-width":"120px","max-width":"120px"},type:"string"},{field:"templateId",title:"Template Id",extraStyles:{"min-width":"100px","max-width":"100px"},type:"string"},{field:"isCustom",title:"Is Custom",type:"chip",extraStyles:{"min-width":"100px","max-width":"100px"},position:"p-start",truthy:{false:"No",true:"Yes"},setChipClass:e=>e.isCustom===!0?"rounded rounded-5 px-3 py-1 text-bg-success cs-w-120":"rounded rounded-5 px-3 py-1 text-bg-danger cs-w-120"},{field:"usageCount",title:"Usage",type:"number",extraStyles:{width:"100px"}},{field:"ownerId",title:"Owner",type:"select",stream:{value:"_id",name:"name",stream:this._lovService.userLov$},extraStyles:{"min-width":"100px"}},{field:"createdAt",title:"Created At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}},{field:"updatedAt",title:"Last Updated At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}}],actionsColumn:{enabled:this._currentScreen.update||this._currentScreen.delete,maxButtons:window.innerWidth<700?1:void 0,maxWidth:window.innerWidth<700?void 0:"110px",minWidth:window.innerWidth<700?void 0:"110px",buttons:[{prefixIcon:{icon:"icon_edit"},label:{text:"Edit"},onClickFn:e=>this._openMenu(e),isVisibleFn:()=>this._currentScreen.update,matType:"mat-icon-button"},{prefixIcon:{icon:"icon_delete",color:"red"},label:{text:"Delete"},onClickFn:e=>this._deleteInventory(e),isVisibleFn:()=>this._currentScreen.delete,matType:"mat-icon-button"}]}}}_openMenu(e){let a={title:{text:e?"Edit Menu Template":"Add Menu Template"},form:{value:e,useExpansionPanel:!0,expandOnlyOne:!0,groups:[{id:5,name:{text:"Template Image",addClass:"h5 mb-1",tag:"p"},order:0},{id:1,name:{text:"Menu Fields",addClass:"h5 mb-1",tag:"p"},order:1},{id:2,name:{text:"Item Fields",addClass:"h5 mb-1",tag:"p"},order:2},{id:3,name:{text:"Subcategory Fields",addClass:"h5 mb-1",tag:"p"},order:3},{id:4,name:{text:"Category Fields",addClass:"h5 mb-1",tag:"p"},order:4}],fields:[{name:"name",label:{text:"Template Name"},required:!0,type:"text"},{name:"templateId",label:{text:"Template Id"},required:!0,type:"text"},{name:"ownerId",type:"select",stream:this._lovService.userLov$,transformer:{valueKey:"_id",nameKey:"name"},label:{text:"Template Owner"}},{name:"isCustom",label:{text:"Is Custom"},type:"checkbox"},{name:"menu_storeLogo_max_size",label:{text:"Store Logo Max Size"},type:"number",groupId:1,disableNegativeValues:!0},{name:"imageUrl",label:{text:"Image"},type:"image",groupId:5,maxSizeInMB:1},{name:"menu_storeLogo",label:{text:"Has Store Logo"},type:"toggle",groupId:1},{name:"menu_translation",label:{text:"Has Translation"},type:"toggle",groupId:1},{name:"menu_category",label:{text:"Has Categories"},type:"toggle",groupId:1},{name:"menu_subcategory",label:{text:"Has Subcategories"},type:"toggle",groupId:1},{name:"menu_item",label:{text:"Has Items"},type:"toggle",groupId:1},{name:"menu_quote",label:{text:"Has Quote"},type:"toggle",groupId:1},{name:"menu_aboutUs",label:{text:"Has About Us"},type:"toggle",groupId:1},{name:"menu_phoneNumber",label:{text:"Has Phone Number"},type:"toggle",groupId:1},{name:"menu_email",label:{text:"Has Email"},type:"toggle",groupId:1},{name:"menu_whatsapp",label:{text:"Has Whatsapp"},type:"toggle",groupId:1},{name:"menu_location",label:{text:"Has Location"},type:"toggle",groupId:1},{name:"menu_instagram",label:{text:"Has Instagram"},type:"toggle",groupId:1},{name:"menu_facebook",label:{text:"Has Facebook"},type:"toggle",groupId:1},{name:"item_img_max_size",label:{text:"Item Img Max Size"},type:"number",groupId:2,disableNegativeValues:!0},{name:"item_bgImg_max_size",label:{text:"Item Bg Img Max Size"},type:"number",groupId:2,disableNegativeValues:!0},{name:"item_img",label:{text:"Has Item Img"},type:"toggle",groupId:2},{name:"item_bgImg",label:{text:"Has Item Bg Img"},type:"toggle",groupId:2},{name:"item_calories",label:{text:"Has Item Calories"},type:"toggle",groupId:2},{name:"item_is_Starred",label:{text:"Has Item Is Starred"},type:"toggle",groupId:2},{name:"item_is_New",label:{text:"Has Item Is New"},type:"toggle",groupId:2},{name:"item_description",label:{text:"Has Item Description"},type:"toggle",groupId:2},{name:"item_unit",label:{text:"Has Item Unit"},type:"toggle",groupId:2},{name:"subcategory_img_max_size",label:{text:"Subcategory Img Max Size"},type:"number",groupId:3,disableNegativeValues:!0},{name:"subcategory_bgImg_max_size",label:{text:"Subcategory Bg Img Max Size"},type:"number",groupId:3,disableNegativeValues:!0},{name:"subcategory_img",label:{text:"Has Subcategory Img"},type:"toggle",groupId:3},{name:"subcategory_bgImg",label:{text:"Has Subcategory Bg Img"},type:"toggle",groupId:3},{name:"subcategory_pageNb",label:{text:"Has Subcategory Page Number"},type:"toggle",groupId:3},{name:"category_img_max_size",label:{text:"Category Img Max Size"},type:"number",groupId:4,disableNegativeValues:!0},{name:"category_bgImg_max_size",label:{text:"Category Bg Img Max Size"},type:"number",groupId:4,disableNegativeValues:!0},{name:"category_img",label:{text:"Has Category Img"},type:"toggle",groupId:4},{name:"category_bgImg",label:{text:"Has Category Bg Img"},type:"toggle",groupId:4}]},beforeCloseObservable:i=>e?this._menuTemplateService.updateMenuTemplate(s(s({},e),i)):this._menuTemplateService.addMenuTemplate(i),getAfterSuccessResponse:i=>{i.data&&this._menuTemplateService._updateMenus(i.data,e?"edit":"add")}};this._dialog.openFormPopup(a,"1000px")}_deleteInventory(e){let a={title:{text:"Confirm Delete"},message:{text:"Are you sure you want to delete this menu template?"}};this._dialog.openConfirmPopup(a).afterClosed().pipe(n(1)).subscribe(i=>{i&&e?._id&&this._menuTemplateService.deleteMenuTemplate(e)})}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=g({type:t,selectors:[["ks-solutions-menu-template-listing"]],standalone:!0,features:[f([l]),S],decls:1,vars:1,consts:[[3,"config","refresh$"]],template:function(a,i){a&1&&_(0,A,1,2,"ks-basic-grid",0),a&2&&y(i.gridConfig?0:-1)},dependencies:[M],changeDetection:0})}}return t})();export{ee as MenuTemplatesComponent};
