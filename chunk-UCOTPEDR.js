import{a as I}from"./chunk-HXKFJ2GE.js";import{a as E}from"./chunk-RN7YLSYN.js";import{a as A}from"./chunk-ERG5Z3O3.js";import{a as s}from"./chunk-V3RKPLKU.js";import{a as k}from"./chunk-O6Z6ZKPB.js";import"./chunk-5YWUWVK4.js";import{a as w}from"./chunk-DDY2ZFNV.js";import{L as T,V as g,Y as M,ma as C}from"./chunk-E5MLKHCJ.js";import"./chunk-CARY4E7O.js";import"./chunk-ARNZMF2R.js";import{Fa as c,Hb as _,N as a,Nb as x,Ub as S,a as o,bc as y,ea as p,ka as r,n as d,o as m,oa as u,sb as h,tc as v,uc as b,zb as f}from"./chunk-42PURYOY.js";var l=(()=>{class t{constructor(){this._networkService=r(M),this._templates=new m([]),this.templates$=this._templates.asObservable()}getAllMenuTemplates(){this._networkService.get(s.MENU_TEMPLATES.menus).pipe(a(1)).subscribe({next:e=>{e&&e.data&&this._templates.next(e.data)}})}addMenuTemplate(e){return this._networkService.post(s.MENU_TEMPLATES.menus,e)}updateMenuTemplate(e){return this._networkService.patch(s.MENU_TEMPLATES.menus,e,e._id)}deleteMenuTemplate(e){this._networkService.delete(s.MENU_TEMPLATES.menus,void 0,e._id).pipe(a(1)).subscribe({next:()=>{this._updateMenus(e,"delete")}})}_updateMenus(e,i){I.UpdateArrayBehaviorSubject(this._templates,e,i)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=p({token:t,factory:t.\u0275fac})}}return t})();function P(t,F){if(t&1&&S(0,"ks-basic-grid",0),t&2){let e=y();_("config",e.gridConfig)("refresh$",e.refresh$)}}var X=(()=>{class t{constructor(){this._destroyRef=r(c),this._navService=r(w),this._lovService=r(A),this._dialog=r(g),this._menuTemplateService=r(l),this._currentScreen=k("menu_templates_listing"),this._data=[],this.refresh$=new d}ngOnInit(){this._navService.updateNav({show:!0,back:!1,title:this._currentScreen.screenName,buttons:[{label:{text:"Create New"},prefixIcon:{icon:"icon_plus_circle"},hide:!this._currentScreen.insert,onClick:()=>{this._openMenu()}}]}),this._menuTemplateService.getAllMenuTemplates(),this._initializeGrid(),this._menuTemplateService.templates$.pipe(T(this._destroyRef)).subscribe(e=>{this._data=e,this.refresh$.next({data:this._data})})}_initializeGrid(){this.gridConfig={data:h([]),defaultPagination:100,maxTableHeight:E.maxTableHeightWithSearch,noDataMessage:{text:"No Menu Templates Found"},features:{showSearch:!0,trackChanges:!0},elevation:2,columns:[{field:"name",title:"Name",extraStyles:{"min-width":"120px","max-width":"120px"},type:"string"},{field:"templateId",title:"Template Id",extraStyles:{"min-width":"100px","max-width":"100px"},type:"string"},{field:"isCustom",title:"Is Custom",type:"chip",extraStyles:{"min-width":"100px","max-width":"100px"},position:"p-start",truthy:{false:"No",true:"Yes"},setChipClass:e=>e.isCustom===!0?"rounded rounded-5 px-3 py-1 text-bg-success cs-w-120":"rounded rounded-5 px-3 py-1 text-bg-danger cs-w-120"},{field:"usageCount",title:"Usage",type:"number",extraStyles:{width:"100px"}},{field:"ownerId",title:"Owner",type:"select",stream:{value:"_id",name:"name",stream:this._lovService.userLov$},extraStyles:{"min-width":"100px"}},{field:"createdAt",title:"Created At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}},{field:"updatedAt",title:"Last Updated At",type:"date",dateFormat:"dd/MM/yyyy - HH:mm:ss a",extraStyles:{"min-width":"170px"}}],actionsColumn:{enabled:this._currentScreen.update||this._currentScreen.delete,maxButtons:window.innerWidth<700?1:void 0,maxWidth:window.innerWidth<700?void 0:"110px",minWidth:window.innerWidth<700?void 0:"110px",buttons:[{prefixIcon:{icon:"icon_edit"},label:{text:"Edit"},onClickFn:e=>this._openMenu(e),isVisibleFn:()=>this._currentScreen.update,matType:"mat-icon-button"},{prefixIcon:{icon:"icon_delete",color:"red"},label:{text:"Delete"},onClickFn:e=>this._deleteInventory(e),isVisibleFn:()=>this._currentScreen.delete,matType:"mat-icon-button"}]}}}_openMenu(e){let i={title:{text:e?"Edit Menu Template":"Add Menu Template"},form:{value:e,fields:[{name:"name",label:{text:"Menu Name"},required:!0,type:"text"},{name:"templateId",label:{text:"Template Id"},required:!0,type:"text"},{name:"ownerId",type:"select",stream:this._lovService.userLov$,transformer:{valueKey:"_id",nameKey:"name"},label:{text:"Menu Owner"}},{name:"isCustom",label:{text:"Is Custom"},type:"checkbox"}]},beforeCloseObservable:n=>e?this._menuTemplateService.updateMenuTemplate(o(o({},e),n)):this._menuTemplateService.addMenuTemplate(n),getAfterSuccessResponse:n=>{n.data&&this._menuTemplateService._updateMenus(n.data,e?"edit":"add")}};this._dialog.openFormPopup(i,"1000px")}_deleteInventory(e){let i={title:{text:"Confirm Delete"},message:{text:"Are you sure you want to delete this menu template?"}};this._dialog.openConfirmPopup(i).afterClosed().pipe(a(1)).subscribe(n=>{n&&e?._id&&this._menuTemplateService.deleteMenuTemplate(e)})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=u({type:t,selectors:[["ks-solutions-menu-template-listing"]],standalone:!0,features:[v([l]),b],decls:1,vars:1,consts:[[3,"config","refresh$"]],template:function(i,n){i&1&&f(0,P,1,2,"ks-basic-grid",0),i&2&&x(n.gridConfig?0:-1)},dependencies:[C],changeDetection:0})}}return t})();export{X as MenuTemplatesComponent};
